import paramiko as para

ip = "your_device_ip"
username = "your_device_user"
password = "device_password"
ssh_conection = None

cmd = """
find /var/containers/Bundle/Application/ -maxdepth 2 -name '*.app' | awk -F "/" '{print $6 " " substr($0, index($0,$7))}'
"""
try:
    ssh_connection = para.SSHClient()
    ssh_connection.set_missing_host_key_policy(para.AutoAddPolicy())
    ssh_connection.connect(ip, username=username, password=password)
    print("Connected to %s" % ip)
except para.AuthenticationException:
    print("Failed to connect to %s due to wrong username or password" %ip)
    exit(1)
except Exception as e:
    print(e)
    exit(2)

try:
    stdin, stdout, stderr = ssh_connection.exec_command(cmd)
except Exception as e:
    print(e)

err = ''.join(stderr.readlines())
out = ''.join(stdout.readlines())
final_output = str(out)+str(err)
print(final_output) 
