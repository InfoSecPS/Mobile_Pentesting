# Mobile_Pentesting
A repo for various Frida or Python scripts that I've created for mobile application tests. I'm not a developer. I Google code when I have an idea or problem to solve. 

## Android 
### shared_prefs.py [link](https://github.com/InfoSecPS/Mobile_Pentesting/blob/main/Android/shared_prefs.py)

A script that downloads the entire contents of an Android application's `shared_prefs` folder on the device located at `/data/data/{packageName}/` - Pass the package name as the first argument. Script will download to the folder the script is executed from. Saves you having to ADB into the device and cat each file. 

### shared_prefs_monitor.js [link](https://github.com/InfoSecPS/Mobile_Pentesting/blob/main/Android/shared_prefs_monitor.js)

A Frida script that monitors when an application is reading or writing to `shared_prefs` of an application sandbox. Run with `frida -U -l shared_prefs_monitor.js -f com.package.name --no-pause` 

### intents_watcher.js [link](https://github.com/InfoSecPS/Mobile_Pentesting/blob/main/Android/intents_watcher.js)

A Frida script that monitors intents for an Android application. Run using `frida -U -l intents_watcher.js -f com.package.name --no-pause`. 

### sqlite_monitor.js [link](https://github.com/InfoSecPS/Mobile_Pentesting/blob/main/Android/sqlite_monitor.js)

A Frida script that monitors SQlite DB behaviour. Essentially showing what the application is writing to the database. Run using `frida -U -l sqlite_monitor.js -f com.package.name --no-pause`. 

## iOS

### bundle_ids.py [link](https://github.com/InfoSecPS/Mobile_Pentesting/blob/main/iOS/bundle_ids.py)

A Python script that quickly loads the bundle IDs for the installed applications on an iOS device. Saves time needing to SSH into the device and run the command, when you forget to grab the Bundle ID of an application. 

### fileSearcher.py [link](https://github.com/InfoSecPS/Mobile_Pentesting/blob/main/iOS/fileSearcher.py)

A Python script that takes `IP, username & password` as arguments for an iOS device SSH connection, and using actions, can search for interesting files within the `.app` directory of an iOS application. 

#### Requirements
Paramiko: `pip install paramiko`

#### Usage
```
usage: iOS_Tool.py [-h] -ip IP -u USERNAME -p PASSWORD --action {bundle-id,inspect-plist,inspect-db,inspect-sqlite,inspect-files} [--bundle-id BUNDLE_ID]

SSH into an iOS device and perform app-related actions.

options:
  -h, --help            show this help message and exit
  -ip IP                IP address of the iOS device
  -u USERNAME, --username USERNAME
                        Username for SSH connection
  -p PASSWORD, --password PASSWORD
                        Password for SSH connection
  --action {bundle-id,inspect-plist,inspect-db,inspect-sqlite,inspect-files}
                        Actions searches for content in an iOS applicating using a bundleID
  --bundle-id BUNDLE_ID
                        Bundle ID of the app to inspect (required for inspect actions)
```
1. Search for app bundle ids `--action bundle-id`.
2. Copy the `bundle-id` of the desired application from the output.
3. Issue `--action inspect-* --bundle-id {bundle-id}` to conduct certain searches for files in the `/private/var/containers/Bundle/Application/{bundle_id}name.app` directory.

The types of files the script searches for are `plist, db, sqlite, json, txt, xml, pdf, doc, docx, ppt, xls, xlsx`.
Find something worth diving into, you can copy the full path from the output and `scp root@IP_address:/path/to/file .` to download it. 

#### Actions
- `inspect-plist`: Searches for `.plist` files
- `inspect-db`: Searches for `.db` files
- `inspect-sqlite`: Searches for `.sqlite` files
- `inspect-files`: Searches for `.txt,.json,.pdf,.doc,.docx,.ppt,.xls,.xlsx,.xml`

The reason for the differnt searches, is that you may only want plist files, or db. No point in flooding the screen with every file possible. 
